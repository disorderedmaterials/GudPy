Bootstrap: library
From: ubuntu:20.04

%post
    apt-get update
    apt-get install python3.8 python3-distutils curl build-essential libx11-xcb-dev libglu1-mesa-dev libxkbcommon0 libglx0 libfontconfig libglib2.0-0 libdbus-1-3 libxcb-xinerama0 libxkbcommon-x11-0 libxcb-icccm4 libxcb-image0 libxcb-keysyms1 libxcb-render-util0 libxcb-shape0 libgfortran5 -y
    curl https://bootstrap.pypa.io/get-pip.py | python3.8
    python3.8 -m pip install PySide6==6.2.0 chardet
    cd /usr/local/lib/python3.8/dist-packages/PySide6
    ls
    ls | grep libpyside6 | xargs ldd
    ls | grep .so | grep -v -e "QtCore.*" -e "QtGui.*" -e "QtCharts.*" -e "QtWidgets.*" -e "libpyside6" -e "libshiboken6" | xargs rm
    cd
    python3.8 -m pip uninstall pip -y
    apt-get remove --auto-remove curl -y
%help

    A singularity container for GudPy.

%setup
    mkdir ${SINGULARITY_ROOTFS}/opt/GudPy

%files

    ./src /opt/GudPy
    ./bin /opt/GudPy
    ./main.py /opt/GudPy

%runscript
    # If the container is executed, this line will be run.
    python3.8 /opt/GudPy/main.py

%apphelp GudPy
    GudPy GUI version.

%apprun GudPy
    python3.8 /opt/GudPy/main.py
